<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ダッシュボード - SGW売上管理</title>
  <link rel="stylesheet" href="/css/style.css">
  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
</head>
<body>
  <header>
    <h1>SGW売上管理 ダッシュボード</h1>
    <p>ようこそ, <%= user.username %> さん (<%= user.role %>)</p>
    <nav>
      <a href="/logout">ログアウト</a>
    </nav>
  </header>
  <div class="tabs">
    <button class="tablink" onclick="openTab(event, 'Calendar')" id="defaultTab">カレンダー</button>
    <button class="tablink" onclick="openTab(event, 'Graph')">グラフ</button>
    <button class="tablink" onclick="openTab(event, 'Settings')">設定</button>
  </div>
  <div id="Calendar" class="tabcontent">
    <div id="monthTotal" style="font-weight:bold; margin-bottom:10px;"></div>
    <div id="calendar" style="min-height:400px;"></div>
  </div>
 <div id="Graph" class="tabcontent" style="display:none">
  <div id="graphNavigation" style="text-align: center; margin-bottom: 10px;">
    <button id="prevMonthBtn" style="font-size: 18px;">&#8592;</button>
    <span id="graphMonthLabel" style="font-weight:bold; font-size: 18px; margin: 0 10px;"></span>
    <button id="nextMonthBtn" style="font-size: 18px;">&#8594;</button>
  </div>
  <canvas id="graphCanvas"></canvas>
 </div>
  <div id="Settings" class="tabcontent" style="display:none">
    <a href="/settings">運賃編集</a>
    <% if(user.username === "deldb") { %>
      <button onclick="resetDatabase()">MongoDB 初期化</button>
    <% } %>
  </div>
  <!-- FullCalendar JS -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/js/dashboard.js"></script>
</body>
</html>
